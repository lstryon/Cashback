<!DOCTYPE html>
<!-- Designined by Luis-->
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8">
    <title> Cashback | VBA Project </title>
    <link rel="stylesheet" href="style.css">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
   </head>
<body>
  <div class="text-boxes-1">
    <div class="topic-3">Cashback | VBA Project by LC</div>
    <div class="topic-2">Instruções:</div>
    <div class="topic-1">Copiar o código VBA</div>
    <div class="topic-1">Abrir Excel</div>
    <div class="topic-1">Alt + F11</div>
    <div class="topic-1">Inserir Modulo</div>
    <div class="topic-1">Colar código VBA</div>
    <div class="topic-1">Executar código - F5</div>
  </div>

  <div class="text-boxes">
    <div class="text-box HTMLBox">
      <div class="topic">Código VBA - Importação Excel:</div>
      <textarea id="HTMLBox" readonly >
Dim valor As String
Dim cell, range1 As Range
        
Sub completar()
        
  Set range1 = Range("b9:b108")
        
    For Each cell In range1
        
      If cell.Value <> "" Then
                valor = Range("b6").Value
                cell.Offset(0, 8).Value = valor
                valor = Range("c6").Value
                cell.Offset(0, 9).Value = valor
                valor = Range("d6").Value
                cell.Offset(0, 10).Value = valor
                valor = Range("e6").Value
                cell.Offset(0, 11).Value = valor
                valor = Range("g6").Value
                cell.Offset(0, 12).Value = valor
                valor = Range("h6").Value
                cell.Offset(0, 13).Value = valor
      Else
                cell.Offset(0, 8).Value = ""
                cell.Offset(0, 9).Value = ""
                cell.Offset(0, 10).Value = ""
                cell.Offset(0, 11).Value = ""
                cell.Offset(0, 12).Value = ""
                cell.Offset(0, 13).Value = ""
      End If
        
    Next

End Sub
        
Sub cashbackImportacao()
        
Dim WS_Count As Integer
Dim I, X As Integer
        
'WS_Count conta o numero de Planilhas
WS_Count = ActiveWorkbook.Worksheets.Count
        
    For X = 1 To WS_Count
        
        Sheets(X).Select
        Call completar
        
    Next X
        
'Criando aba nova
        
      Sheets.Add
            ActiveCell.FormulaR1C1 = "codigo"
            Range("b1").Select
            ActiveCell.FormulaR1C1 = "gatilho"
            Range("c1").Select
            ActiveCell.FormulaR1C1 = "tipoPorcentagem"
            Range("d1").Select
            ActiveCell.FormulaR1C1 = "valorReceberCashback"
            Range("e1").Select
            ActiveCell.FormulaR1C1 = "quantidadeMaximaProduto"
            Range("f1").Select
            ActiveCell.FormulaR1C1 = "preco"
            Range("g1").Select
            ActiveCell.FormulaR1C1 = "descricao"
            Range("h1").Select
            ActiveCell.FormulaR1C1 = "imagem"
            Range("i1").Select
            ActiveCell.FormulaR1C1 = "descricaoPackCashback"
            Range("j1").Select
            ActiveCell.FormulaR1C1 = "CPF - NOME DO COMPRADOR"
            Range("k1").Select
            ActiveCell.FormulaR1C1 = "CÓDIGO - NOME DA INDÚSTRIA"
            Range("l1").Select
            ActiveCell.FormulaR1C1 = "INVESTIMENTO TOTAL"
            Range("m1").Select
            ActiveCell.FormulaR1C1 = "PERÍODO"
            Range("n1").Select
            ActiveCell.FormulaR1C1 = "REGIONAL/LOJAS"
            Range("o1").Select
            ActiveCell.FormulaR1C1 = "NOME CAMPANHA"
            Range("p1").Select
        
'Começo do loop aba a aba
         
    For I = 1 To WS_Count + 1
         
        Sheets(I).Select
            Range("c9:c65").Select
            Selection.Copy
            Sheets("Planilha1").Select
            ' cola na próxima em vazio
            Cells(Rows.Count, "A").End(xlUp).Offset(1, 0).PasteSpecial: Application.CutCopyMode = False
            
            Sheets(I).Select
            Range("e9:e65").Select
            Application.CutCopyMode = False
            Selection.Copy
            Sheets("Planilha1").Select
            ' cola na próxima em vazio
            Cells(Rows.Count, "B").End(xlUp).Offset(1, 0).PasteSpecial: Application.CutCopyMode = False
            
            Sheets(I).Select
            Range("f9:f65").Select
            Application.CutCopyMode = False
            Selection.Copy
            Sheets("Planilha1").Select
            ' cola na próxima em vazio
            Cells(Rows.Count, "D").End(xlUp).Offset(1, 0).PasteSpecial: Application.CutCopyMode = False
            
            Sheets(I).Select
            Range("g9:g65").Select
            Application.CutCopyMode = False
            Selection.Copy
            Sheets("Planilha1").Select
            ' cola na próxima em vazio
            Cells(Rows.Count, "E").End(xlUp).Offset(1, 0).PasteSpecial: Application.CutCopyMode = False
            
            Sheets(I).Select
            Range("d9:d65").Select
            Application.CutCopyMode = False
            Selection.Copy
            Sheets("Planilha1").Select
            ' cola na próxima em vazio
            Cells(Rows.Count, "G").End(xlUp).Offset(1, 0).PasteSpecial: Application.CutCopyMode = False
            
            Sheets(I).Select
            Range("j9:j65").Select
            Selection.Copy
            Sheets("Planilha1").Select
            ' cola na próxima em vazio
            Cells(Rows.Count, "j").End(xlUp).Offset(1, 0).PasteSpecial: Application.CutCopyMode = False
        
            Sheets(I).Select
            Range("k9:k65").Select
            Application.CutCopyMode = False
            Selection.Copy
            Sheets("Planilha1").Select
            ' cola na próxima em vazio
            Cells(Rows.Count, "k").End(xlUp).Offset(1, 0).PasteSpecial: Application.CutCopyMode = False
            
            Sheets(I).Select
            Range("l9:l65").Select
            Application.CutCopyMode = False
            Selection.Copy
            Sheets("Planilha1").Select
            ' cola na próxima em vazio
            Cells(Rows.Count, "l").End(xlUp).Offset(1, 0).PasteSpecial: Application.CutCopyMode = False
        
            Sheets(I).Select
            Range("m9:m65").Select
            Application.CutCopyMode = False
            Selection.Copy
            Sheets("Planilha1").Select
            ' cola na próxima em vazio
            Cells(Rows.Count, "m").End(xlUp).Offset(1, 0).PasteSpecial: Application.CutCopyMode = False
        
            Sheets(I).Select
            Range("n9:n65").Select
            Application.CutCopyMode = False
            Selection.Copy
            Sheets("Planilha1").Select
            ' cola na próxima em vazio
            Cells(Rows.Count, "n").End(xlUp).Offset(1, 0).PasteSpecial: Application.CutCopyMode = False
        
        
            Sheets(I).Select
            Range("o9:o65").Select
            Application.CutCopyMode = False
            Selection.Copy
            Sheets("Planilha1").Select
            ' cola na próxima em vazio
            Cells(Rows.Count, "o").End(xlUp).Offset(1, 0).PasteSpecial: Application.CutCopyMode = False
            
            
    Next I
        
      Columns("A:O").Select
            Columns("A:O").EntireColumn.AutoFit
            Selection.Borders(xlDiagonalDown).LineStyle = xlNone
            Selection.Borders(xlDiagonalUp).LineStyle = xlNone
            With Selection.Borders(xlEdgeLeft)
                .LineStyle = xlContinuous
                .ColorIndex = 0
                .TintAndShade = 0
                .Weight = xlThin
            End With
            With Selection.Borders(xlEdgeTop)
                .LineStyle = xlContinuous
                .ColorIndex = 0
                .TintAndShade = 0
                .Weight = xlThin
            End With
            With Selection.Borders(xlEdgeBottom)
                .LineStyle = xlContinuous
                .ColorIndex = 0
                .TintAndShade = 0
                .Weight = xlThin
            End With
            With Selection.Borders(xlEdgeRight)
                .LineStyle = xlContinuous
                .ColorIndex = 0
                .TintAndShade = 0
                .Weight = xlThin
            End With
            With Selection.Borders(xlInsideVertical)
                .LineStyle = xlContinuous
                .ColorIndex = 0
                .TintAndShade = 0
                .Weight = xlThin
            End With
            With Selection.Borders(xlInsideHorizontal)
                .LineStyle = xlContinuous
                .ColorIndex = 0
                .TintAndShade = 0
                .Weight = xlThin
            End With
            With Selection.Interior
                .PatternColorIndex = xlAutomatic
                .ThemeColor = xlThemeColorDark1
                .TintAndShade = 0
                .PatternTintAndShade = 0
            End With
            Range("A1:O1").Select
            With Selection.Interior
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
                .ThemeColor = xlThemeColorDark1
                .TintAndShade = -0.149998474074526
                .PatternTintAndShade = 0
            End With
            Range("A1").Select
        
'Completar com não <> ""
        
    Dim cell, range3 As Range
            
      Set range3 = Range("c2:c300")
        
      For Each cell In range3
            If cell.Offset(0, -2).Value <> "" Then
                cell.Value = "não"
            Else
                cell.Value = ""
            End If
        
      Next
          
End Sub

      </textarea>
      <button id="HTMLButton">Copiar Código</button>
    </div>
  </div>

  <br> <br>

  <div class="text-boxes">
    <div class="text-box HTMLBox">
      <div class="topic">Código VBA - Congelamento:</div>
      <textarea id="HTMLBox2" readonly >
Sub cashback()

Dim WS_Count As Integer
Dim I As Integer

'WS_Count conta o numero de Planilhas
WS_Count = ActiveWorkbook.Worksheets.Count

'Criando aba nova

    Sheets.Add
    ActiveCell.FormulaR1C1 = "CÓD. REDUZIDO"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = "PREÇO"
    Range("A2").Select

' Começo do loop aba a aba
 
 For I = 1 To WS_Count + 1
 
    Sheets(I).Select
    Range("B9:B65").Select
    Selection.Copy
    Sheets("Planilha1").Select
    ' cola na próxima em vazio
    Cells(Rows.Count, "A").End(xlUp).Offset(1, 0).PasteSpecial: Application.CutCopyMode = False
    
    Sheets(I).Select
    Range("H9:H65").Select
    Application.CutCopyMode = False
    Selection.Copy
    Sheets("Planilha1").Select
    ' cola na próxima em vazio
    Cells(Rows.Count, "B").End(xlUp).Offset(1, 0).PasteSpecial: Application.CutCopyMode = False
    
  Next I
  
' Final do loop


' Classificar na aba nova

    Columns("A:A").Select
    ActiveWorkbook.Worksheets("Planilha1").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Planilha1").Sort.SortFields.Add2 Key:=Range( _
        "A1:A400"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Planilha1").Sort
        .SetRange Range("A2:C400")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Cells.Select
    Cells.EntireColumn.AutoFit
    Cells(2, 4).Select
    Cells(2, 4).Value = "Processo Finalizado"
    Columns("d:d").EntireColumn.AutoFit
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.399975585192419
        .PatternTintAndShade = 0
    End With
    
    Range("D2:E2").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    Range("D3").Select
    ActiveCell.FormulaR1C1 = "Qnt CÓD. REDUZIDO"
    Range("E3").Select
    ActiveCell.FormulaR1C1 = "=COUNTA(R[-1]C[-4]:R[297]C[-4])"
    Range("D3:E3").Select
    Range("E3").Activate
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Range("D2:E2").Select
    
    Range("A:A,B:B").Select
    Range("B1").Activate
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -9.99786370433668E-02
        .PatternTintAndShade = 0
    End With
    Range("D2:E2").Select

' Final classificar

End Sub
      </textarea>
      <button id="HTMLButton2">Copiar Código</button>
    </div>
  </div>

  <br> <br> <br>



  <script>
  // HTML BOx Code 1
    let HTMLBox = document.getElementById("HTMLBox");
    let HTMLButton = document.getElementById("HTMLButton");

    HTMLButton.onclick = function() {
      HTMLBox.select();
      document.execCommand("copy");
      HTMLButton.innerText = "Código Copiado"
    }

    // HTML BOx Code 2
    let HTMLBox2 = document.getElementById("HTMLBox2");
    let HTMLButton2 = document.getElementById("HTMLButton2");

    HTMLButton2.onclick = function() {
      HTMLBox2.select();
      document.execCommand("copy");
      HTMLButton2.innerText = "Código Copiado"
    }
  </script>


</body>
</html>
